<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<link rel="stylesheet" type="text/css" href="css/global.css" />

	<title>Calculadora em Javascript</title>
	
	<script language="javascript">

	/******************************************************
	* JSCalc, calculadora em Javascript
	*
	* Fork desenvolvido por:
	*	- InFog - Evaldo Junior (http://infog.casoft.info) <junior_pd_bento@yahoo.com.br>
	*
	* A JSCalc é baseada na CALC-JS
	* desenvolvida pelo Peterson <peterson770@hotmail.com>
	*
	* A CALC-JS desenvolvida pelo Peterson já tinha
	* um bom mapa de imagem, por isso fiz um fork,
	* para não precisar reinventar a roda e aproveitar
	* o bom trabalho que já estava pronto.
	*
	* Este fork teve início em 21 de setembro de 2008
	*
	* Por que fazer um fork?
	* Quero fazer um visor com os digitos no estilo
	* de calculadoras mesmo, mas por enquanto vou usar
	* o input de texto.
	*
	* Este software é licenciado sobre a GPLv3
	* Uma cópia da licença foi distrbuída com esta código
	* Este software não tem garantias, use por conta e risco.
	*
	* Versão 0.1 - 21/09/2008
	* 	- Versão original e sem modificações.
	* 
	* Versão 0.2 - 21/09/2008
	*	- Adicionados comentários e créditos (antes não tinha nada)
	*	- Adicionada variável com a versão do software.
	*	- Removida a função Mouse(), que mostrava uma mensagem quando usado o botão direito do mouse.
	*	- Removidas variáveis cont, n1, n2, n3, n4 e n5.
	*	- Removidas variáveis numero1, numero2, numero3, numero4, numero 5 e resultado.
	*	- Adicionada variável MEM1, que conterá o que estava no visor antes de usar alguma operação.
	*	- Adicionada variável OPERADOR.
	*	- Alterada a função recebe_tecla() para que trabalhe com switch e não um monte de if aninhado.
	*	- Adicionada a função executa_funcao(), por enquanto ela tem apenas comentários de como deve funcionar
	*	- Adicionada a função add_ponto() também apenas com comentários
	*	- Adicionada a função add_operador() também apenas com comentários
	*	- Removida a verificação do operador na função add_visor();
	*	- Removida a função continhas();
	*	- Removido o site que tinha ao redor da calculador, deixei apenas o código dela, assim fica mais simples
	*	  para embuutila em algum outro site.
	*	- Crei um projeto no google code e hospedei a JSCalc, http://code.google.com/p/jscalc/
	* 
	******************************************************/

	var VERSAO = "0.2";
	var VISOR = "0"; // iniciando o visor como 0
	var MEM1 = "0"; // variável que contém o que estava no visor antes de usar uma tecla de operação.
	var OPERADOR = ""; // variável com o operador (+, -, / ou *)
	
	function recebe_tecla(tecla)
	{
		switch (tecla)
		{
			case "raiz":
				executa_funcao("raiz");
			break;
			case "0":
	                        add_visor("0");
	                break;
			case "1":
				add_visor("1");
			break;
			case "2":
				add_visor("2");
			break;
			case "3":
				add_visor("3");
			break;
			case "4":
				add_visor("4")
			break;
			case "5":
				add_visor("5");
			break;
			case "6":
				add_visor("6");
			break;
			case "7":
	                        add_visor("7");
	                break;
	                case "8":
	                        add_visor("8");
	                break;
	                case "9":
	                        add_visor("9");
	                break;
			case ".":
	                        add_ponto();
	                break;
			case "=":
	                        calcula_resultado();
	                break;
			case "+":
	                        add_operador("+");
	                break;
			case "-":
	                        add_operador("-");
	                break;
			case "/":
	                        add_operador("/");
	                break;
			case "*":
	                        add_operador("*");
	                break;
			case "+":
	                        add_operador("+");
	                break;
			case "limpa":
				limpa_visor();
			break;
		}
	}
		
	function executa_funcao(funcao)
	{
		/*******************************************
		* Esta função executa funções da calculadora
		*
		* Funções disponíveis:
		*	- raiz (extrai a raiz do número no visor)
		*******************************************/
	}

	function add_ponto()
	{
		/*******************************************
                * Esta função serve para adicionar um ponto
		* separador de casas decimais ao visor.
                *******************************************/
	}

	function add_operador(operador)
	{
		/*******************************************
                * Esta função adiciona um operador,
		* ela precisa mover o conteúdo do VISOR
		* para MEM1 e aplicar o operador.
		* Ainda não tenho muita ideia de como ela
		* vai funcionar.
                *******************************************/
	}

	function add_visor(valor)
	{

		if (VISOR == "0")
		{
			VISOR = valor;
		}
		else 
		{
			VISOR = VISOR + valor;
		}
		atualiza_visor();			
	}

		
	function checa_operando(x) 
	{
		switch (x)
		{
			case "+":
				cont = 1;
			break;
			case "-":
				cont = 2;
			break;
			case "*":
				cont = 3;
			break;
			case "/":
				cont = 4;
			break;
			case "=":
				resultado_final();
			break;
		}
	}

	function atualiza_visor()
	{
		document.getElementById('vis').value = VISOR;	
	}

	function limpa_visor()
	{
		VISOR = "0";
		atualiza_visor();		
	}

	function resultado_final()
	{			
		if (cont == 1)
		{
			resultado = eval(document.getElementById('vis').value );
		}
		VISOR = resultado;
		atualiza_visor();
		cont = 0;		
	}		
	</script>
</head>
<body>
	<div id="mainContent">
		<div id="calculadora" name="calculadora">
			<!-- Este é o DIV do visor da calculadorazinha =] -->
			<div id="visor-calc" name="calc">
			<input type="text" id="vis" name="vis"/>
		</div>
		
		<!-- E este é o mapeamento da calculadora e cada mapeamento chama a função alerta -->
		<img src ="calc.jpg" width ="220" height ="300" border="0" usemap ="#calcmap"  />
		<map id ="calcmap" name="calcmap">
			<area shape ="rect" coords ="40,120,60,138" onclick="recebe_tecla('raiz')" /> 
			<area shape ="rect" coords ="40,145,60,163" onclick="recebe_tecla('7')" />
			<area shape ="rect" coords ="40,175,60,193" onclick="recebe_tecla('4')" /> 
			<area shape ="rect" coords ="40,210,60,230" onclick="recebe_tecla('1')"  /> 	
			<area shape ="rect" coords ="40,250,60,260" onclick="recebe_tecla('0')"  />

			<area shape ="rect" coords ="80,120,100,138" onclick="recebe_tecla('%')" />
			<area shape ="rect" coords ="80,145,100,163" onclick="recebe_tecla('8')" />
			<area shape ="rect" coords ="80,175,100,193" onclick="recebe_tecla('5')" />
			<area shape ="rect" coords ="80,210,100,230" onclick="recebe_tecla('2')" />
			<area shape ="rect" coords ="80,250,100,260" onclick="recebe_tecla('.')"  />

			<area shape ="rect" coords ="120,120,140,138" onclick="recebe_tecla('away')"  />
			<area shape ="rect" coords ="120,145,140,163" onclick="recebe_tecla('9')"  />
			<area shape ="rect" coords ="120,175,140,193" onclick="recebe_tecla('6')"  />
			<area shape ="rect" coords ="120,210,140,230" onclick="recebe_tecla('3')"  />
			<area shape ="rect" coords ="115,245,140,260" onclick="recebe_tecla('=')" />

			<area shape ="rect" coords ="160,120,180,138" onclick="recebe_tecla('/')"  />
			<area shape ="rect" coords ="160,145,180,163" onclick="recebe_tecla('x')"  />
			<area shape ="rect" coords ="160,175,180,193" onclick="recebe_tecla('-')"  />
			<area shape ="rect" coords ="160,210,180,260" onclick="recebe_tecla('+')"  />

			<area shape ="rect" coords ="130,85,180,100" onclick="recebe_tecla('clear')" />
		</map>
		Que a gra&ccedil;a do nosso SENHOR JESUS esteja com todos. 
	</div>
	<script language="javascript">
		atualiza_visor();
	</script>
</body>
</html>

